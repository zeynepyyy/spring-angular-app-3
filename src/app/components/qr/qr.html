<div class="qr-container">
    <div class="page-header">
        <button routerLink="/dashboard" class="back-btn">â† Geri</button>
        <h2>QR Ä°ÅŸlemleri</h2>
    </div>

    @if (!scanSuccess()) {
    <div class="scan-area">
        <div class="camera-frame" [class.scanning]="isScanning()">
            @if (!cameraPermission()) {
            <div class="cam-placeholder">
                <span class="icon">ğŸ“·</span>
                <p>QR okutmak iÃ§in kamerayÄ± aÃ§Ä±n</p>
            </div>
            } @else {
            <div class="live-cam">
                <div class="scan-line"></div>
            </div>
            }
        </div>

        @if (!isScanning()) {
        <button class="primary-btn" (click)="startScan()">
            {{ cameraPermission() ? 'Tekrar Tara' : 'KamerayÄ± AÃ§' }}
        </button>
        } @else {
        <p>TaranÄ±yor...</p>
        }
    </div>
    } @else {
    <div class="transaction-form card-anim">
        <div class="success-msg">
            <span class="check">âœ…</span>
            <p>QR Kod BaÅŸarÄ±yla Okundu!</p>
            <small>ATM ID: #TR-8842</small>
        </div>

        <div class="form-group">
            <label>Hesap SeÃ§in</label>
            <select class="form-input" (change)="selectedAccountId.set(+$any($event.target).value)">
                @for (acc of accounts(); track acc.id) {
                <option [value]="acc.id">{{ acc.accountNumber }} - {{ acc.balance }} TL</option>
                }
            </select>
        </div>

        <div class="form-group">
            <label>Ä°ÅŸlem TÃ¼rÃ¼</label>
            <div class="toggle-group">
                <button [class.active]="action() === 'WITHDRAW'" (click)="action.set('WITHDRAW')">Para Ã‡ek</button>
                <button [class.active]="action() === 'DEPOSIT'" (click)="action.set('DEPOSIT')">Para YatÄ±r</button>
            </div>
        </div>

        <div class="form-group">
            <label>Tutar</label>
            <input type="number" [ngModel]="amount()" (ngModelChange)="amount.set($event)" class="form-input"
                placeholder="0.00">
        </div>

        <button class="confirm-btn" (click)="confirmTransaction()">Ä°ÅŸlemi Onayla</button>
    </div>
    }
</div>